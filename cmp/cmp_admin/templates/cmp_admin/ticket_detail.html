{% extends 'cmp_admin/base.html' %}

{% block extra-css %}

<style>
  .card {
    width: 80vw;
    margin: auto;
  }
</style>

{% endblock extra-css %}

{% block main %}

<h1 class="title">Chamado #{{ ticket.pk }}</h1>

<div class="card mb-4">
  <div class="card-header">
    <p class="card-header-title">Dados de abertura:</p>
  </div>
  <div class="card-content">
    <div class="content">
      <p><strong>Local: </strong>{{ ticket.place_id }}</p>
      <p><strong>Setor: </strong>{{ ticket.sector_id }}</p>
      <p><strong>Solicitante: </strong>{{ ticket.requester }}</p>
      <p><strong>Telefone: </strong>{{ ticket.contact_phone }}</p>
      <p><strong>E-mail: </strong>{{ ticket.contact_email }}</p>
      <p><strong>Assunto: </strong>{{ ticket.subject_id }}</p>
      <p><strong>Serviço: </strong>{{ ticket.service_id }}</p>
      <p><strong>Descrição: </strong>{{ ticket.description }}</p>
      <p><strong>Aberto em: </strong>{{ ticket.created_at }}</p>
      <p><strong>Atualizado em: </strong>{{ ticket.updated_at }}</p>
    </div>
  </div>
</div>

<div class="card mb-4">
  <div class="card-header">
    <p class="card-header-title">Andamento do chamado:</p>
  </div>
  <div class="card-content">
    <div class="content">
      <p><strong>Status: </strong>{{ ticket.status_id }}</p>
      <p><strong>Responsável: </strong>{{ ticket.assigned_to_id }}</p>

      <table class="table">
        <thead>
          <tr>
            <th>Usuário</th>
            <th>Informação</th>
            <th>Data/hora</th>
          </tr>
        </thead>
        <tbody>
          {% for info in ticket.infos.all %}

          <tr>
            <td>{{ info.user_id }}</td>
            <td>{{ info.description }}</td>
            <td>{{ info.created_at }}</td>
          </tr>
    
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-header">
    <p class="card-header-title">Solução do chamado:</p>
  </div>
  <div class="card-content">
    <div class="content">
      <p><strong>Problema detectado: </strong>{{ ticket.issue }}</p>
      <p><strong>Solução aplicada: </strong>{{ ticket.solution }}</p>
    </div>
  </div>
</div>

{% endblock main %}